# ARG「海蝕機関」実装ガイド

## 作成されたファイルの概要

このディレクトリには、ARGプロジェクト「海蝕機関」を拡張するための具体的なコード例が含まれています。

### 1. データファイル

#### logs_enhanced.json
- **目的**: 拡張された日報データ
- **内容**: 11件の日報（元の3件から大幅に増加）
- **新機能**: 
  - `division`フィールド追加（部門名）
  - `threatLevel`フィールド追加（1-5の脅威レベル）
  - 多様な脅威レベルの事案
  - より詳細な本文内容

**実装方法**:
```bash
# 既存のlogs.jsonをバックアップ
cp /internal/deta/logs.json /internal/deta/logs_backup.json

# 新しいデータで置き換え
cp logs_enhanced.json /internal/deta/logs.json
```

#### diaries_enhanced.json
- **目的**: 拡張された海蝕員日記
- **内容**: 12件の日記（元の3件から4倍に増加）
- **新機能**:
  - 新人から指揮官まで、多様な立場の視点
  - 時系列での精神汚染の進行
  - キャラクター間の関連性

**実装方法**:
```bash
cp diaries_enhanced.json /internal/deta/diaries.json
```

### 2. JavaScript機能拡張

#### search_enhanced.js
- **目的**: 高度な検索・フィルタリング機能
- **新機能**:
  - 部門別フィルター
  - 脅威レベルフィルター
  - 日付範囲フィルター
  - 複数の並び替えオプション
  - タイムライン表示機能

**実装方法**:
```javascript
// 既存のsearch.jsの代わりに使用
// main.jsで以下のようにインポート:
import { initSearch, initTimeline } from './js/search_enhanced.js';
```

**主要な関数**:

```javascript
// 検索実行
performSearch(query) // 高度なフィルタリング付き検索

// タイムライン初期化
initTimeline() // タイムライン表示の初期化

// 結果表示
displayResults(results) // 検索結果の表示
```

### 3. HTML拡張

#### search_advanced.html
- **目的**: 高度な検索インターフェース
- **機能**:
  - フィルター付き検索フォーム
  - リスト表示とタイムライン表示の切り替え
  - レスポンシブデザイン
  - アクセス権限チェック

**実装方法**:
既存の日報検索ページを置き換えるか、新しいページとして追加:
```bash
cp search_advanced.html /internal/search_advanced.html
```

**CSS要件**:
既存のCSSに以下のクラスを追加する必要があります:
- `.threat-low`, `.threat-medium`, `.threat-high`, `.threat-critical`
- `.timeline-container`, `.timeline-item`, `.timeline-marker`
- `.division-badge`, `.threat-badge`

#### index_with_puzzles.html
- **目的**: 謎解き要素を追加した公開サイトのトップページ
- **機能**:
  - HTMLコメントに隠しメッセージ
  - Base64エンコードされた手がかり
  - コンソールログのイースターエッグ
  - Konamiコードの実装
  - クリックカウンターのトリガー

**実装方法**:
```bash
# 既存のindex.htmlをバックアップ
cp /index.html /index_backup.html

# 新バージョンをコピー
cp index_with_puzzles.html /index.html
```

**謎解き要素の詳細**:

1. **HTMLコメント内の座標**:
   ```html
   <!-- 
   座標: 35.6762, 139.6503
   日付: 2026-02-14
   暗号: テツキョウ ワ ヒラク ツキ ノ ナイ ヨル ニ
   -->
   ```

2. **コンソールメッセージ**:
   - ブラウザのDevToolsを開くとヒントが表示される
   - 隠しページへのリンクとパスワードを提供

3. **Konamiコード**:
   - ↑↑↓↓←→←→BA で隠しページへ移動

4. **ロゴクリック**:
   - 7回クリックで座標のヒント表示

## 実装の優先順位

### フェーズ1: 即座に実装可能（1週間以内）

1. **データファイルの置き換え**
   - logs_enhanced.json → logs.json
   - diaries_enhanced.json → diaries.json
   - 効果: コンテンツが3倍以上に増加

2. **謎解き要素の追加**
   - index_with_puzzles.html → index.html
   - 効果: プレイヤーの探索意欲を刺激

### フェーズ2: 中期実装（2-4週間）

1. **検索機能の強化**
   - search_enhanced.js の統合
   - search_advanced.html の追加
   - 効果: ユーザビリティが大幅に向上

2. **タイムライン表示**
   - timeline機能の実装
   - 効果: 時系列での事案把握が容易に

### フェーズ3: 長期実装（1-3ヶ月）

1. **バックエンド開発**
   - データベースの導入
   - API開発
   - ユーザー認証の強化

2. **追加機能**
   - ユーザー投稿機能
   - リアルタイム更新
   - マルチメディアコンテンツ

## 技術的な注意点

### セキュリティ
現在の実装は教育/エンターテインメント目的です。本番環境では以下を考慮:
- HTTPS の使用
- 適切な認証システム
- XSS対策
- CSRF対策

### パフォーマンス
データ量が増加するため:
- ページネーションの実装を推奨
- 検索結果のキャッシング
- 遅延読み込み（Lazy Loading）

### ブラウザ互換性
- ES6 Modules を使用（IE11非対応）
- Fetch API を使用
- モダンブラウザ推奨（Chrome, Firefox, Safari, Edge）

## テスト方法

### 1. ローカルサーバーの起動

```bash
# Python 3がインストールされている場合
cd /path/to/project
python -m http.server 8000

# Node.jsがインストールされている場合
npx http-server -p 8000
```

ブラウザで `http://localhost:8000` にアクセス

### 2. 検索機能のテスト

1. `/internal/search_advanced.html` にアクセス
2. 各フィルターを試す:
   - 部門: "収束部門"を選択
   - 脅威レベル: レベル3を選択
   - 日付範囲: 2025-01-01 から 2025-12-31
3. タイムライン表示に切り替え

### 3. 謎解き要素のテスト

1. トップページ (`index.html`) にアクセス
2. ブラウザのDevToolsを開く（F12）
3. Consoleタブでヒントを確認
4. ページのソースを表示（Ctrl+U）してHTMLコメントを確認
5. ロゴを7回クリックしてアラートを確認

## 次のステップ

### コンテンツ追加

1. **日報を20-30件に増加**
   - 各部門から均等に
   - 脅威レベルのバランス
   - 時系列の一貫性

2. **日記を15-20件に増加**
   - 新キャラクターの追加
   - 既存キャラクターの続編
   - 精神汚染の進行描写

3. **音声ログの追加**
   - テキストベースの音声ログ
   - 無線通信記録
   - 階底次元との交信記録

### UI/UX改善

1. **プログレストラッカー**
   - 読んだ日報の記録
   - 達成度の表示
   - バッジシステム

2. **お気に入り機能**
   - 重要な日報のブックマーク
   - LocalStorage での保存
   - 共有機能

3. **ダークモード**
   - 既にダークテーマだが、さらに調整可能な明るさ
   - システム設定との連動

### 謎解き要素の拡張

1. **暗号パズル**
   - シーザー暗号
   - ヴィジュネル暗号
   - モールス信号
   - 16進数/Base64

2. **座標パズル**
   - 複数の日報に散らばった座標
   - Google Maps との連携
   - QRコードの生成

3. **ステガノグラフィー**
   - 画像内の隠しテキスト
   - 音声スペクトログラム
   - PDFのメタデータ

## サポートとフィードバック

実装中に問題が発生した場合:

1. ブラウザのコンソールでエラーを確認
2. ファイルパスが正しいか確認
3. JSONファイルの構文エラーをチェック（JSON Linterを使用）

改善提案:
- 新しいストーリーラインのアイデア
- UI/UXの改善案
- 技術的な最適化

## まとめ

このコード集は、ARG「海蝕機関」を次のレベルに引き上げるための
具体的な実装例を提供しています。

**重要なポイント**:
1. まずデータファイルを置き換えてコンテンツを増やす
2. 謎解き要素を追加してプレイヤーを引き込む
3. 検索機能を強化してユーザビリティを向上
4. 段階的に機能を追加していく

プロジェクトの成功を祈ります！
